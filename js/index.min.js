$(function(){console.log("");var e=$("#regist-form"),r={Regex:{MOBILE:/^1\d{10}$/,ISCODE:/^[0-9]{6}$/i,ISPWD:/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,16}$/},changeRegState:function(r){var s=e.find("#register-btn");"registering"===r?s.data("state","registering").text("注册中..."):s.data("state",null).text("注册领红包")}},s={phone:function(){var s=e.find("#phone"),n=s.val(),t=s.siblings(".msg");return""!=$.trim(n)?r.Regex.MOBILE.test(n)?(t.html("").removeClass("error-msg"),!0):(t.html("输入手机号码格式不正确").addClass("error-msg"),!1):(t.html("手机号码不能为空").addClass("error-msg"),!1)},password:function(){var s=e.find("#pwd"),n=s.val(),t=s.siblings(".msg");return n.indexOf(" ")>-1?(t.html("密码不允许含有空格").addClass("error-msg"),!1):""!=$.trim(n)?r.Regex.ISPWD.test(n)?(t.html("").removeClass("error-msg"),!0):(t.html("密码格式错误，必须为6-16个字符(包含字母+数字)").addClass("error-msg"),!1):(t.html("密码不能为空").addClass("error-msg"),!1)},imgCode:function(){var r=e.find("#imgcode"),s=r.val(),n=r.siblings(".msg");return""==$.trim(s)?(n.html("图形验证码不能为空").addClass("error-msg"),!1):(n.html("").removeClass("error-msg"),!0)},telCode:function(){var s=e.find("#identifycode"),n=s.val(),t=s.siblings(".msg");return""!=$.trim(n)?r.Regex.ISCODE.test(n)?(t.html("").removeClass("error-msg"),!0):(t.html("验证码错误,请重新输入").addClass("error-msg"),!1):(t.html("请输入验证码").addClass("error-msg"),!1)}},n=function(s){if(s.preventDefault(),"registering"===$(this).data("state"))return!1;e.find(".form-control").each(function(){var e=$(this);e.trigger("blur")});var n=e.find(".error-msg");n.length>0||$.ajax({url:"?t="+1e3*Math.random(),type:"post",data:e.serialize(),beforeSend:function(){r.changeRegState("registering")},success:function(e){e.success?location.href="":(r.changeRegState(),alert(e.msg||"注册失败，请重新注册！"))},error:function(){r.changeRegState(),alert("注册失败，请重新注册！")}})};e.on("blur","input.form-control",function(){var e=$(this),r=e.data("flag");"phone"===r?s.phone():"password"===r?s.password():"imgcode"===r?s.imgCode():"identifycode"===r&&s.telCode()}),e.on("focus","input.form-control",function(){var e=$(this).siblings(".msg");e.html("").removeClass("error-msg")}),e.on("click","#register-btn",n),$("#packet").on("click",function(){$(".newcomer-packet").css("display","block")}),$("#jdcard").on("click",function(){$(".jdcard-rule").css("display","block")}),$("#bbin").on("click",function(){$(".newcomer-bbin").css("display","block")}),$("#member").on("click",function(){$(".member-rights").css("display","block")}),$(".newcomer-packet").on("click",".close",function(){var e=$(".newcomer-packet");e.css("display","none")}),$(".jdcard-rule").on("click",".close",function(){var e=$(".jdcard-rule");e.css("display","none")}),$(".newcomer-bbin").on("click",".close",function(){var e=$(".newcomer-bbin");e.css("display","none")}),$(".member-rights").on("click",".close",function(){var e=$(".member-rights");e.css("display","none")})});